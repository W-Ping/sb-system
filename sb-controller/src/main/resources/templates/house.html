<!DOCTYPE html>
<!--suppress ALL -->
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>我的装修</title>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1">
    <link rel="shortcut icon" href="/static/favicon.ico">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="stylesheet" href="//g.alicdn.com/msui/sm/0.6.2/css/sm.min.css">
    <link rel="stylesheet" href="//g.alicdn.com/msui/sm/0.6.2/css/sm-extend.min.css">
    <style>
        .to-page-link {
            margin: 10rem 1rem;
        }

        .button.button-middle {
            width: 60%;
            margin: 0 auto;
            font-size: 0.85rem;
            height: 2.0rem;
            line-height: 1.9rem;
        }

        .budgetResult-box {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            /*position: fixed;*/
            /*z-index: 9999;*/
            /*bottom: 3.1rem*/
        }

        .budgetResult {
            display: flex;
            width: 8rem;
            height: 8rem;
            border-radius: 50%;
            align-items: center;
            justify-content: center;
            flex-direction: row;
            background: #4cd964;
        }

        .budgetResult-insert {
            display: flex;
            width: 7rem;
            height: 7rem;
            flex-direction: column;
            border-radius: 50%;
            align-items: center;
            justify-content: center;
            background: white;
        }

        .swiper-container {
            margin: 0 auto;
            position: relative;
            overflow: hidden;
            padding-top: 1rem;
            z-index: 1;
        }
    </style>
</head>
<body>
<div class="page" id="page-house">
    <nav class="bar bar-tab">
        <a th:href="@{'/house/page/0?mobile_phone='+${mobilePhone}}"
           th:class="${type==0}?'tab-item external active':'tab-item external'">
            <span class="icon icon-home"></span>
            <span class="tab-label">我的房子</span>
        </a>
        <a th:href="@{'/house/page/1?mobile_phone='+${mobilePhone}}"
           th:class="${type==1}?'tab-item external active':'tab-item external'">
            <span class="icon icon-computer"></span>
            <span class="tab-label">我的房间</span>
        </a>
        <a th:href="@{'/house/page/2?mobile_phone='+${mobilePhone}}"
           th:class="${type==2}?'tab-item external active':'tab-item external'">
            <span class="icon icon-settings"></span>
            <span class="tab-label">装修房间</span>
        </a>
        <a th:href="@{'/house/page/3?mobile_phone='+${mobilePhone}}"
           th:class="${type==3}?'tab-item external active':'tab-item external'">
            <span class="icon icon-star"></span>
            <span class="tab-label">材料仓库</span>
        </a>

    </nav>
    <div th:if="${type==0}" class="content">
        <header class="bar bar-nav">
            <h1 class='title'>我的房子</h1>
        </header>
        <form id="houseForm">
            <input hidden th:value="${id}" name="id">
            <div class="content">
                <div class="list-block">
                    <ul>
                        <li>
                            <div class="item-content">
                                <div class="item-media"><i class="icon icon-form-name"></i></div>
                                <div class="item-inner">
                                    <div class="item-title label">手机号码</div>
                                    <div class="item-input">
                                        <input type="number" th:readonly="${isRegister}"
                                               th:value="${isRegister?mobilePhone:houseVo?.mobilePhone}"
                                               name="mobilePhone" required onfocus="inputFocus()"
                                               placeholder="手机号码">
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="item-content">
                                <div class="item-media"><i class="icon icon-form-name"></i></div>
                                <div class="item-inner">
                                    <div class="item-title label">房屋面积</div>
                                    <div class="item-input">
                                        <input type="number" th:value="${houseVo?.houseAreaSize}" name="houseAreaSize"
                                               required onfocus="inputFocus()"
                                               placeholder="（单位：平米）">
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="item-content">
                                <div class="item-media"><i class="icon icon-form-gender"></i></div>
                                <div class="item-inner">
                                    <div class="item-title label">房屋类型</div>
                                    <div class="item-input">
                                        <select name="houseType" onfocus="inputFocus()">
                                            <option value="0" th:selected="${houseVo?.houseType==0}">新房</option>
                                            <option value="1" th:selected="${houseVo?.houseType==1}">二手房</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="item-content">
                                <div class="item-media"><i class="icon icon-form-name"></i></div>
                                <div class="item-inner">
                                    <div class="item-title label">房屋户型</div>
                                    <div class="item-input">
                                        <input type="text" name="apartment" placeholder="选择户型" required id='picker-name'
                                               onclick="inputFocus()" th:value="${houseVo?.apartment}">
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="align-top">
                            <div class="item-content">
                                <div class="item-media"><i class="icon icon-form-comment"></i></div>
                                <div class="item-inner">
                                    <div class="item-title label">备注</div>
                                    <div class="item-input">
                                        <textarea name="remark" onfocus="inputFocus()" th:text="${houseVo?.remark}"
                                                  placeholder="备注"></textarea>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="content-block" style=" margin: 1.2rem 0;" id="submitBut" hidden>
                    <div class="row">
                        <div class="col-50"><a href="javascript:;" onclick="resetHouse()"
                                               class="button button-big button-fill button-danger">重置</a></div>
                        <div class="col-50">
                            <a href="javascript:;" onclick="submitHouse('/house/save')"
                               class="button button-big button-fill button-success">提交</a>
                        </div>

                    </div>
                </div>
                <div th:if="${totalAmount!=null or minTotalAmount!=null or maxTotalAmount!=null}"
                     class="swiper-pagination budgetResult-box bdg-pagination"></div>
                <div class="swiper-container" data-space-between='10' data-pagination='.swiper-pagination'>
                    <div class="swiper-wrapper">
                        <div th:if="${totalAmount!=null}" class="swiper-slide budgetResult-box">
                            <div class="budgetResult">
                                <div class="budgetResult-insert">
                                    <span>我的预算费用</span>
                                    <p>
                            <span style="font-size: 25px;"
                                  th:text="${totalAmount>=10000?(totalAmount/10000):totalAmount}"></span>
                                        <span style="font-size: 20px;"
                                              th:text="${totalAmount>=10000?'万元':'元'}"></span>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div th:if="${minTotalAmount!=null}" class="swiper-slide budgetResult-box">
                            <div class="budgetResult" style="background: #0894ec;">
                                <div class="budgetResult-insert">
                                    <span>最低预算费用</span>
                                    <p>
                            <span style="font-size: 25px;"
                                  th:text="${totalAmount>=10000?(minTotalAmount/10000):minTotalAmount}"></span>
                                        <span style="font-size: 20px;"
                                              th:text="${minTotalAmount>=10000?'万元':'元'}"></span>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div th:if="${maxTotalAmount!=null}" class="swiper-slide budgetResult-box">
                            <div class="budgetResult" style="background: #ff6600;">
                                <div class="budgetResult-insert">
                                    <span>最高预算费用</span>
                                    <p>
                            <span style="font-size: 25px;"
                                  th:text="${totalAmount>=10000?(maxTotalAmount/10000):maxTotalAmount}"></span>
                                        <span style="font-size: 20px;"
                                              th:text="${maxTotalAmount>=10000?'万元':'元'}"></span>
                                    </p>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </form>
    </div>
    <div th:if="${type==1}" class="content infinite-scroll infinite-scroll-bottom">
        <input hidden th:value="${mobilePhone}" id="mobilePhone">
        <div class="content-block" th:if="${permitDecoration}">
            <!--            <div th:if="${#lists.isEmpty(roomVos)}">-->
            <div th:if="${houseVo!=null and houseVo.balcony ge 1}"
                 th:each="i,stat:${#numbers.sequence(1,houseVo.balcony)}">
                <p><a href="#" th:attr="data-roomType=4,data-index=${i}"
                      class="button button-fill button-middle button-success create-room"
                      th:text="${'阳台'+i}"></a></p>
            </div>
            <div th:if="${houseVo!=null and houseVo.livingroom ge 1}"
                 th:each="i,stat:${#numbers.sequence(1,houseVo.livingroom)}">
                <p><a href="#" th:attr="data-roomType=1,data-index=${i}"
                      class="button button-fill button-middle button-dark create-room"
                      th:text="${'客厅'+i}"> </a></p>
            </div>
            <div th:if="${houseVo!=null and houseVo.bedroom ge 1}"
                 th:each="i,stat:${#numbers.sequence(1,houseVo.bedroom)}">
                <p><a href="#" th:attr="data-roomType=0,data-index=${i}"
                      class="button button-fill button-middle button-primary create-room"
                      th:text="${'卧室'+i}"> </a></p>
            </div>
            <div th:if="${houseVo!=null and houseVo.kitchen ge 1}"
                 th:each="i,stat:${#numbers.sequence(1,houseVo.kitchen)}">
                <p><a href="#" th:attr="data-roomType=2,data-index=${i}"
                      class="button button-fill button-middle button-danger create-room"
                      th:text="${'厨房'+i}"></a></p>
            </div>
            <div th:if="${houseVo!=null and houseVo.toilet ge 1}"
                 th:each="i,stat:${#numbers.sequence(1,houseVo.toilet)}">
                <p><a href="#" th:attr="data-roomType=3,data-index=${i}"
                      class="button button-fill button-middle button-warning create-room"
                      th:text="${'卫生间'+i}"> </a></p>
            </div>
            <!--            </div>-->
        </div>
        <div class="content-block" th:unless="${permitDecoration}">
            <div class="content-padded to-page-link">
                <div class="row">
                    <div class="col-50">
                        <a th:href="@{'/house/page/0?mobile_phone='+${mobilePhone}}"
                           class="button button-big button-fill external">创建房子</a>
                    </div>
                    <div class="col-50">
                        <a th:href="@{'/house/page/3?mobile_phone='+${mobilePhone}}"
                           class="button button-big button-fill button-warning external">装修材料</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="popup room-popup">
            <header class="bar bar-nav">
                <h1 class='title' id="room-title">编辑</h1>
            </header>
            <form id="roomForm">
                <input hidden th:value="${houseVo?.houseCode}" name="houseCode">
                <input hidden id="room-type" name="roomType">
                <input hidden id="room-index" name="roomIndex">
                <input hidden id="room-detailName" name="houseDetailName">
                <input hidden id="houseDetailCode" name="houseDetailCode">
                <div class="list-block">
                    <ul>
                        <li>
                            <div class="item-content">
                                <div class="item-media"><i class="icon icon-form-name"></i></div>
                                <div class="item-inner">
                                    <div class="item-title label">名称</div>
                                    <div class="item-input">
                                        <input type="text" name="roomNickName" placeholder="名称">
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="item-content">
                                <div class="item-media"><i class="icon icon-form-name"></i></div>
                                <div class="item-inner">
                                    <div class="item-title label">顶面积</div>
                                    <div class="item-input">
                                        <input type="number" name="floorAreaSize" placeholder="(单位:平米)">
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="item-content">
                                <div class="item-media"><i class="icon icon-form-name"></i></div>
                                <div class="item-inner">
                                    <div class="item-title label">墙面积</div>
                                    <div class="item-input">
                                        <input type="number" name="wallAreaSize" placeholder="(单位:平米)">
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="item-content">
                                <div class="item-media"><i class="icon icon-form-name"></i></div>
                                <div class="item-inner">
                                    <div class="item-title label">地面积</div>
                                    <div class="item-input">
                                        <input type="number" name="ceilAreaSize" placeholder="(单位:平米)">
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li class="align-top">
                            <div class="item-content">
                                <div class="item-media"><i class="icon icon-form-comment"></i></div>
                                <div class="item-inner">
                                    <div class="item-title label">备注</div>
                                    <div class="item-input">
                                        <textarea name="remark" placeholder="备注"></textarea>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </form>
            <div class="content-block">
                <div class="row">
                    <div class="col-50"><a href="#"
                                           class="button button-big button-fill button-danger close-popup">取消</a></div>
                    <div class="col-50"><a href="#" onclick="submitRoom()"
                                           class="button button-big button-fill button-success">提交</a></div>
                </div>
            </div>
        </div>
    </div>
    <div th:if="${type==2}" class="content infinite-scroll infinite-scroll-bottom">
        <div class="content-block" th:if="${#lists.isEmpty(roomVos)}">
            <div class="content-padded to-page-link">
                <div class="row" style="margin: 0 auto; width: 60%;">
                    <div>
                        <a th:href="@{'/house/page/1?mobile_phone='+${mobilePhone}}"
                           class="button button-big button-fill  external">我的房子</a>
                    </div>
                </div>
            </div>
        </div>
        <dive th:unless="${#lists.isEmpty(roomVos)}" th:each="vo,stat:${roomVos}">
            <div class="card">
                <h3>
                    <div class="card-header"
                         th:text="${vo?.houseDetailName}+${vo.roomNickName!=null && vo.roomNickName!=''?'【'+vo.roomNickName+'】':''}"></div>
                </h3>
                <div class="card-content">
                    <div class="list-block inset">
                        <ul th:each="hbVo,stat2:${vo?.houseBudgetInfoVos}">
                            <li>
                                <a class="item-content item-link"
                                   th:href="@{'/house/detail/decorate/'+${hbVo?.houseDetailCode}+'?hbc='+${hbVo?.houseBudgetCode}}">
                                    <div class="item-media"><i class="icon icon-f7"></i></div>
                                    <div class="item-inner">
                                        <div class="item-title" th:text="${hbVo?.budgetName}"></div>
                                        <div class="item-title"
                                             th:text="${hbVo?.budgetAmount * hbVo?.budgetCount}+' 元'"></div>
                                        <!--                                        <div class="item-title" th:text="${hbVo?.budgetCount}"></div>-->
                                        <div class="item-after"></div>
                                    </div>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="list-block inset">
                        <a class="item-content item-link list-button"
                           th:href="@{'/house/detail/decorate/'+${vo?.houseDetailCode}}">添加材料</a>
                    </div>
                </div>
                <div class="card-footer">
                    <a th:href="@{'/budget/query/list/'+${vo?.houseDetailCode}+'/'+${mobilePhone}}"
                       class="link" style="font-size: 16px;">选择材料</a>
                    <label style="font-size: 16px;"
                           th:text="'合计：'+${vo!=null and vo.totalBudgetAmount!=null ?vo.totalBudgetAmount:0}+' 元'"></label>
                    <!--                    <a href="#" th:attr="data-houseDetailCode=${vo?.houseDetailCode}" th:onclick="calculate(this)"-->
                    <!--                       class="link"-->
                    <!--                    >计算成本</a>-->
                </div>
            </div>

        </dive>
        <!--        <div class="infinite-scroll-preloader">-->
        <!--            <div class="preloader"></div>-->
        <!--        </div>-->
    </div>
    <div th:if="${type==3}" class="content  infinite-scroll infinite-scroll-bottom">
        <input hidden th:value="${mobilePhone}" id="mobilePhone">
        <dive th:each="vo,stat:${list}">
            <div class="card">
                <h3>
                    <div class="card-header" th:text="${vo?.budgetName}"></div>
                </h3>
                <div class="card-content">
                    <div class="list-block inset">
                        <ul>
                            <li>
                                <a class="item-content item-link"
                                   th:href="@{'/house/page/budget/0/'+${mobilePhone}+'?bg_code='+${vo?.budgetCode}+'&val='+${vo?.budgetName}}">
                                    <div class="item-media"><i class="icon icon-f7"></i></div>
                                    <div class="item-inner">
                                        <div class="item-title">材料名称</div>
                                        <div class="item-after" th:text="${vo?.budgetName}"></div>
                                    </div>
                                </a>
                            </li>
                            <li>
                                <a class="item-content item-link"
                                   th:href="@{'/house/page/budget/3/'+${mobilePhone}+'?bg_code='+${vo?.budgetCode}+'&val='+${vo?.maxCost}}">
                                    <div class="item-media"><i class="icon icon-f7"></i></div>
                                    <div class="item-inner">
                                        <div class="item-title">最高成本</div>
                                        <div class="item-after" th:text="${vo?.maxCost}"></div>
                                    </div>
                                </a>
                            </li>
                            <li>
                                <a class="item-content item-link"
                                   th:href="@{'/house/page/budget/4/'+${mobilePhone}+'?bg_code='+${vo?.budgetCode}+'&val='+${vo?.minCost}}">
                                    <div class="item-media"><i class="icon icon-f7"></i></div>
                                    <div class="item-inner">
                                        <div class="item-title">最低成本</div>
                                        <div class="item-after" th:text="${vo?.minCost}"></div>
                                    </div>
                                </a>
                            </li>
                            <li>
                                <a class="item-content item-link"
                                   th:href="@{'/house/page/budget/5/'+${mobilePhone}+'?bg_code='+${vo?.budgetCode}+'&val='+${vo?.actualCost}}">
                                    <div class="item-media"><i class="icon icon-f7"></i></div>
                                    <div class="item-inner">
                                        <div class="item-title">实际成本</div>
                                        <div class="item-after" th:text="${vo?.actualCost}"></div>
                                    </div>
                                </a>
                            </li>
                            <li>
                                <a class="item-content item-link"
                                   th:href="@{'/house/page/budget/2/'+${mobilePhone}+'?bg_code='+${vo?.budgetCode}+'&val='+${vo?.budgetAmount}}">
                                    <div class="item-media"><i class="icon icon-f7"></i></div>
                                    <div class="item-inner">
                                        <div class="item-title">预算金额</div>
                                        <div class="item-after" th:text="${vo?.budgetAmount}"></div>
                                    </div>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="card-footer">
                    <a href="#" style="font-size: 16px;" class="link" onclick="zan()">赞</a>
                    <a href="#" style="font-size: 16px; color: red;"
                       th:onclick="'javascript:deleteBudget(\''+${vo.id}+'\')'"
                       class="link">删除</a>
                </div>
            </div>

        </dive>
        <div class="content-block">
            <p style="width: 60%;margin: auto;">
                <a href="javascript:;" class="button button-big button-fill button-round create-popup">添加</a>
            </p>
        </div>
    </div>
</div>
<script type='text/javascript' src='//g.alicdn.com/sj/lib/zepto/zepto.min.js' charset='utf-8'></script>
<script type='text/javascript' src='//g.alicdn.com/msui/sm/0.6.2/js/sm.min.js' charset='utf-8'></script>
<script type='text/javascript' src='//g.alicdn.com/msui/sm/0.6.2/js/sm-extend.min.js' charset='utf-8'></script>
<script>
    function outFocus() {
        let e = $("#submitBut")
        e.css("visibility", "hidden");
        e.hide();
        // if (e.css("visibility") == "visible") {
        //     e.css("visibility", "hidden");
        //     e.hide();
        // } else {
        //     e.css("visibility", "visible");
        //     e.show();
        // }
    }

    function zan() {
        $.toast("您已点赞");
    }

    function inputFocus() {
        let e = $("#submitBut")
        e.css("visibility", "visible");
        e.show();
    }

    function resetHouse() {
        window.location.reload();
    }

    function submitHouse(url) {
        let data = $('#houseForm').serializeArray();
        let param = {};
        for (let i = 0; i < data.length; i++) {
            let dataName = data[i]['name'];
            let dataValue = data[i]['value'];
            if (!dataValue) {
                if ('mobilePhone' == dataName) {
                    $.toast("请输入手机号码！");
                    return;
                } else if ('houseAreaSize' == dataName) {
                    $.toast("请输入房屋面积！");
                    return;
                }
            }
            if (dataName == 'apartment') {
                if (!dataValue) {
                    $.toast("请选择房屋户型！")
                    return;
                }
                let split = dataValue.split(",");
                param['bedroom'] = split[0].substr(0, 1);
                param['livingroom'] = split[1].substr(0, 1);
                param['kitchen'] = split[2].substr(0, 1);
                param['toilet'] = split[3].substr(0, 1);
                param['balcony'] = split[4].substr(0, 1);
            } else {
                param[dataName] = dataValue;
            }
        }
        console.log("参数%o", param);
        $.ajax({
            type: 'POST',
            contentType: 'application/json',
            url: url,
            data: JSON.stringify(param),
            success: function (result) {
                if (result.code == 200) {
                    $.toast('提交成功！');
                    let href = window.location.href;
                    let mobilePhone = param['mobilePhone'];
                    href = href.substr(0, href.indexOf("=") + 1);
                    window.history.replaceState(null, null, href + mobilePhone)
                } else {
                    $.toast(result.message);
                }
                // window.history.pushState(null, null, href + mobilePhone)
            },
            error: function (result, type, err) {
                $.toast("提交失败!");
            }
        });
    }

    function deleteBudget(id) {
        if (!id) {
            $.toast("主键不存在！");
            return;
        }
        let url = '/budget/delete/' + id;
        $.confirm('确定要删除吗?', function () {
            $.ajax({
                type: 'DELETE',
                url: url,
                success: function (result) {
                    if (result.code == 200) {
                        $.toast('删除成功！');
                        window.location.reload();
                    } else {
                        $.toast(result.message);
                    }
                },
                error: function (result, type, err) {
                    $.toast("删除失败!");
                }
            })
        });

    }

    function submitBudget() {
        let data = $('#budgetForm').serializeArray();
        let url = '/budget/save';
        let param = {};
        param['mobilePhone'] = $('#mobilePhone').val();
        for (let i = 0; i < data.length; i++) {
            let dataName = data[i]['name'];
            let dataValue = data[i]['value'];
            if (!dataValue && dataName != 'actualCost') {
                let dd = $('input[name=' + dataName + ']').attr("placeholder");
                $.toast(dd + "值不能为空！");
                return;
            }
            param[dataName] = dataValue;
        }
        console.log("请求路径%o", url);
        console.log("请求参数%o", param);
        $.ajax({
            type: 'POST',
            contentType: 'application/json',
            url: url,
            data: JSON.stringify(param),
            success: function (result) {
                console.log("数据%o", result);
                if (result.code == 200) {
                    $.toast('提交成功！');
                    $.closeModal()
                    $(".popup-overlay").remove('modal-overlay-visible');
                    window.location.reload();
                } else {
                    $.toast(result.message);
                }
            },
            error: function (result, type, err) {
                $.toast(err);
            }
        });
    }

    function submitRoom() {
        let data = $('#roomForm').serializeArray();
        let url = "/house/save_room";
        let param = {};
        for (let i = 0; i < data.length; i++) {
            let dataName = data[i]['name'];
            let dataValue = data[i]['value'];
            param[dataName] = dataValue;
        }
        $.ajax({
            type: 'POST',
            contentType: 'application/json',
            url: url,
            data: JSON.stringify(param),
            success: function (result) {
                console.log("数据%o", result);
                if (result.code == 200) {
                    $.toast('提交成功！');
                    $(".modal-overlay").remove('modal-overlay-visible');
                    $.closeModal();
                } else {
                    $.toast(result.message);
                }
            },
            error: function (result, type, err) {
                $.toast("提交失败!");
            }
        });
    }

    function calculate(e) {
        console.log(e);
        let houseDetailCode = $(e).attr("data-houseDetailCode");
        console.log(houseDetailCode);
    }

    $(document).on('click', '.create-room', function (e) {
        let roomType = $(this).attr("data-roomType");
        let roomIndex = $(this).attr("data-index");
        let mobilePhone = $("#mobilePhone").val();
        let title = $(this).text();
        $("#room-title").text(title);
        $("#room-detailName").val(title);
        $("#room-type").val(roomType)
        $("#room-index").val(roomIndex)
        $("input[name='roomNickName']").val("");
        $("input[name='floorAreaSize']").val("");
        $("input[name='wallAreaSize']").val("");
        $("input[name='ceilAreaSize']").val("");
        $("textarea[name='remark']").val("");
        let url = '/house/detail/' + roomType + "/" + roomIndex + "?mobile_phone=" + mobilePhone
        $.ajax({
            type: 'GET',
            url: url,
            success: function (result) {
                if (result.code == 200) {
                    console.log("detial数据%o", result);
                    let objVal = result.obj;
                    if (objVal) {
                        $("input[name='roomNickName']").val(objVal['roomNickName']);
                        $("input[name='floorAreaSize']").val(objVal['floorAreaSize']);
                        $("input[name='wallAreaSize']").val(objVal['wallAreaSize']);
                        $("input[name='ceilAreaSize']").val(objVal['ceilAreaSize']);
                        $("textarea[name='remark']").val(objVal['remark']);
                        $("#houseDetailCode").val(objVal['houseDetailCode']);
                    }
                    $.popup(".room-popup");
                    $(".popup-overlay").removeClass("modal-overlay-visible")
                } else {
                    $.toast(result.message);
                }
            },
            error: function (result, type, err) {
                $.toast(err);
            }
        })

    })

    $(document).on('click', '.create-popup', function () {
        let popupHTML = '<div class="popup">' +
            '<header class="bar bar-nav">' +
            '<h1 class="title">新增</h1>' +
            '</header>' +
            '<form id="budgetForm">' +
            '<div class="list-block">' +
            '<ul>' +
            '<li>' +
            '<div class="item-content">' +
            '<div class="item-media"><i class="icon icon-form-name"></i></div>' +
            '<div class="item-inner">' +
            '<div class="item-title label">材料名称</div>' +
            '<div class="item-input">' +
            '<input type="text" name="budgetName" placeholder="材料名称">' +
            '</div>' +
            '</div>' +
            '</div>' +
            '</li>' +
            '<li>' +
            '<div class="item-content">' +
            '<div class="item-media"><i class="icon icon-form-name"></i></div>' +
            '<div class="item-inner">' +
            '<div class="item-title label">最高成本</div>' +
            '<div class="item-input">' +
            '<input type="text" name="maxCost" placeholder="最高成本">' +
            '</div>' +
            '</div>' +
            '</div>' +
            '</li>' +
            '<li>' +
            '<div class="item-content">' +
            '<div class="item-media"><i class="icon icon-form-name"></i></div>' +
            '<div class="item-inner">' +
            '<div class="item-title label">最低成本</div>' +
            '<div class="item-input">' +
            '<input type="text" name="minCost" placeholder="最低成本">' +
            '</div>' +
            '</div>' +
            '</div>' +
            '</li>' +
            '<li>' +
            '<div class="item-content">' +
            '<div class="item-media"><i class="icon icon-form-name"></i></div>' +
            '<div class="item-inner">' +
            '<div class="item-title label">实际成本</div>' +
            '<div class="item-input">' +
            '<input type="text" name="actualCost" placeholder="实际成本">' +
            '</div>' +
            '</div>' +
            '</div>' +
            '</li>' +
            '<li>' +
            '<div class="item-content">' +
            '<div class="item-media"><i class="icon icon-form-name"></i></div>' +
            '<div class="item-inner">' +
            '<div class="item-title label">预算金额</div>' +
            '<div class="item-input">' +
            '<input type="text" name="budgetAmount" placeholder="金额">' +
            '</div>' +
            '</div>' +
            '</div>' +
            '</li>' +
            '</ul>' +
            '</div>' +
            '</form>' +
            '<div class="content-block">' +
            '<div class="row">' +
            '<div class="col-50"><a href="javascript:;"   class="button button-big button-fill button-danger close-popup">取消</a></div>' +
            '<div class="col-50"><a href="javascript:;" onclick="submitBudget()" id="submitBudget" class="button button-big button-fill button-success ">提交</a></div>' +
            '</div> </div>' +
            '</div>'

        $.popup(popupHTML);
    });

    $("#picker-name").picker({
        toolbarTemplate: '<header class="bar bar-nav">\
  <button class="button button-link pull-right close-picker">确定</button>\
  <h1 class="title">请选择户型</h1>\
  </header>',
        cols: [
            {
                textAlign: 'center',
                values: ['1室', '2室', '3室', '4室', '5室', '6室'],
                //如果你希望显示文案和实际值不同，可以在这里加一个displayValues: [.....]
            },
            {
                textAlign: 'center',
                values: ['1厅', '2厅', '3厅', '4厅', '5厅', '6厅'],
            },
            {
                textAlign: 'center',
                values: ['1厨', '2厨', '3厨', '4厨', '5厨', '6厨'],
            },
            {
                textAlign: 'center',
                values: ['1卫', '2卫', '3卫', '4卫', '5卫', '6卫'],
            },
            {
                textAlign: 'center',
                values: ['1阳台', '2阳台', '3阳台', '4阳台', '5阳台', '6阳台'],
            }
        ],
        formatValue: function (picker, value, displayValue) {
            return value;
        }
    });
    $.init();
</script>
</body>
</html>